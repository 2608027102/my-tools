const { contextBridge, ipcRenderer } = require('electron');

contextBridge.exposeInMainWorld('electronAPI', {
  hideWindow: () => ipcRenderer.send('hide-window'),
  executeCommand: (command) => ipcRenderer.send('execute-command', command),
  onCommandExecuted: (callback) => ipcRenderer.on('command-executed', callback),
  getPlugins: () => ipcRenderer.send('get-plugins'),
  onPluginsLoaded: (callback) => ipcRenderer.on('plugins-loaded', callback),
  getPluginCommands: () => ipcRenderer.send('get-plugin-commands'),
  onPluginCommandsLoaded: (callback) => ipcRenderer.on('plugin-commands-loaded', callback),
  executePluginCommand: (data) => ipcRenderer.send('execute-plugin-command', data),
  executePluginCommandWithList: (data) => ipcRenderer.send('execute-plugin-command-with-list', data),
  onPluginCommandExecuted: (callback) => ipcRenderer.on('plugin-command-executed', callback),
  onPluginCommandExecutedWithList: (callback) => ipcRenderer.on('plugin-command-executed-with-list', callback),
  reloadPlugins: () => ipcRenderer.send('reload-plugins'),
  onPluginsReloaded: (callback) => ipcRenderer.on('plugins-reloaded', callback),
  loadCommands: () => ipcRenderer.send('load-commands'),
  onCommandsLoaded: (callback) => ipcRenderer.on('commands-loaded', callback),
  addCommand: (command) => ipcRenderer.send('add-command', command),
  onCommandAdded: (callback) => ipcRenderer.on('command-added', callback),
  updateCommand: (data) => ipcRenderer.send('update-command', data),
  onCommandUpdated: (callback) => ipcRenderer.on('command-updated', callback),
  deleteCommand: (id) => ipcRenderer.send('delete-command', id),
  onCommandDeleted: (callback) => ipcRenderer.on('command-deleted', callback),
  getTheme: () => ipcRenderer.send('get-theme'),
  onThemeLoaded: (callback) => ipcRenderer.on('theme-loaded', callback),
  setTheme: (themeName) => ipcRenderer.send('set-theme', themeName),
  onThemeUpdated: (callback) => ipcRenderer.on('theme-updated', callback),
  getAllThemes: () => ipcRenderer.send('get-all-themes'),
  onThemesLoaded: (callback) => ipcRenderer.on('themes-loaded', callback),
  getApps: () => ipcRenderer.send('get-apps'),
  onAppsLoaded: (callback) => ipcRenderer.on('apps-loaded', callback),
  searchApps: (query) => ipcRenderer.send('search-apps', query),
  onAppsSearched: (callback) => ipcRenderer.on('apps-searched', callback),
  executeApp: (app) => ipcRenderer.send('execute-app', app),
  onAppExecuted: (callback) => ipcRenderer.on('app-executed', callback),
  copyToClipboard: (text) => ipcRenderer.send('copy-to-clipboard', text),
  onCopyToClipboardComplete: (callback) => ipcRenderer.on('copy-to-clipboard-complete', callback),
  getClipboardContent: () => ipcRenderer.send('get-clipboard-content'),
  onClipboardContentRetrieved: (callback) => ipcRenderer.on('clipboard-content-retrieved', callback),
  // 窗口分离相关
  detachWindow: (pluginState) => ipcRenderer.send('detach-window', pluginState),
  closeDetachWindow: () => ipcRenderer.send('close-detach-window'),
  maximizeDetachWindow: () => ipcRenderer.send('maximize-detach-window'),
  minimizeDetachWindow: () => ipcRenderer.send('minimize-detach-window'),
  toggleAlwaysOnTop: () => ipcRenderer.send('toggle-always-on-top'),
  syncPluginState: (pluginState) => ipcRenderer.send('sync-plugin-state', pluginState),
  executePluginCommandInDetach: (data) => ipcRenderer.send('execute-plugin-command-in-detach', data),
  onDetachWindowRequest: (callback) => ipcRenderer.on('detach-window-request', callback),
  onRestorePluginState: (callback) => ipcRenderer.on('restore-plugin-state', callback),
  onInitializeDetachWindow: (callback) => ipcRenderer.on('initialize-detach-window', callback),
  onPluginCommandExecutedInDetach: (callback) => ipcRenderer.on('plugin-command-executed-in-detach', callback)
});